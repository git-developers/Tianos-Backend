{% extends "ThemesBundle:Adminlte:1_template.html.twig" %}

{% block bodyclass %}{% spaceless %}
    {{ vars.body_css }}
{% endspaceless %}{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    
    <style>
        input[type=checkbox] {
            height: 16px;
            width: 16px;
        }
    </style>

{% endblock %}

{% block javascripts %}
    {{ parent() }}

    {% javascripts
        '@AssociativeacademicBundle/Resources/public/js/boxInfo.js'
        '@AssociativeacademicBundle/Resources/public/js/boxOneSearch.js'
        '@AssociativeacademicBundle/Resources/public/js/boxOneSelectItem.js'
        '@AssociativeacademicBundle/Resources/public/js/boxTwoSelectItem.js'
    %}
        <script type="text/javascript" src="{{ asset_url }}"></script>
    {% endjavascripts %}


    <script type="text/javascript">
        $(function() {

            $('div#{{ boxOne.id }}').boxOneSearch({
                boxId: '{{ boxOne.id }}',
                searchInputName: '{{ boxOne.search_input_name }}',
                routeSearch: '{{ path(boxOne.route_search) }}',
            });

            $('div#{{ boxOne.id }}').boxOneSelectItem({
                boxOneId: '{{ boxOne.id }}',
                boxTwoId: '{{ boxTwo.id }}',
                boxThreeId: '{{ boxThree.id }}',
                liClass: '{{ boxOne.li_class }}',
                routeSelectItem: '{{ path(boxOne.route_select_item) }}',
            });

            $('div#{{ boxTwo.id }}').boxTwoSelectItem({
                boxOneId: '{{ boxOne.id }}',
                boxTwoId: '{{ boxTwo.id }}',
                boxThreeId: '{{ boxThree.id }}',
                liClass: '{{ boxTwo.li_class }}',
                boxOneLiInputName: '{{ boxOne.li_input_name }}',
                routeSelectItem: '{{ path(boxTwo.route_select_item) }}',
            });

            $( "form" ).submit(function( event ) {
                event.preventDefault();

                var infoBox = $('#info-box');
                var infoBoxSpan = infoBox.find('span');
                var boxIconDefault = $('#box-icon-default');
                var boxIconRefresh = $('#box-icon-refresh');
                var boxIconThumbsUp = $('#box-icon-thumbs-up');
                var fields = $(this).serializeArray();

                console.log(fields);

                $.ajax({
                    url: '{{ path(box.route_submit) }}',
                    type: 'POST',
                    dataType: 'json',
                    data: fields,
                    beforeSend: function(jqXHR, settings) {
                        $('button[type="submit"]').prop('disabled', true);
                        boxIconDefault.hide();
                        boxIconRefresh.show();
                    },
                    success: function(data, textStatus, jqXHR) {

                        $('button[type="submit"]').prop('disabled', false);
                        boxIconRefresh.hide();
                        boxIconThumbsUp.show();
                        infoBoxSpan.removeClass('bg-aqua').addClass('bg-green');

                        setTimeout(function(){
                            boxIconThumbsUp.hide();
                            boxIconDefault.show();
                            infoBoxSpan.removeClass('bg-green').addClass('bg-aqua');
                        }, 1500);

                    },
                    error: function(jqXHR, exception) {
                        $('button[type="submit"]').prop('disabled', false);
                        boxIconRefresh.hide();
                        boxIconDefault.show();
                    }
                });


            });

        });
    </script>



{% endblock %}

{% block content %}

    <section class="content-header">
        <h1>
            <i class="fa fa-fw fa-{{ box.icon }}"></i> {{ box.title|raw }}
            <small>newspaper</small>
        </h1>
        <ol class="breadcrumb">
            {#<li><a href="#"><i class="fa fa-dashboard"></i> Home</a></li>#}
            {#<li class="active">Dashboard</li>#}

            <li>
                <button
                    class="btn btn-xs btn-info modal-info"
                    alt="Info"
                    title="Info"
                    data-toggle="modal"
                    data-target="#modal-info"
                    style="margin-right: 5px">
                    <i class="fa fa-fw fa-info-circle"></i> Info
                </button>
            </li>
        </ol>
    </section>

    <section class="content">

        <form name="{{ box.form_name }}" method="post">

            <div class="row">

                {#ONE#}
                <div id="{{ boxOne.id }}" class="col-md-3">
                    <div class="box box-success box-solid">
                        <div class="box-header with-border">
                            <h3 class="box-title">
                                <i class="fa fa-fw fa-{{ boxOne.icon }}"></i> {{ boxOne.title }}
                            </h3>
                            <div class="box-tools pull-right">
                                <div class="row">
                                    <div class="col-md-offset-6 col-md-6">
                                        <div class="input-group">
                                            <input name="{{ boxOne.search_input_name }}" type="search" class="form-control" maxlength="50">
                                            <span class="input-group-addon">
                                                <i class="fa fa-fw fa-search"></i>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                                {#<ul class="pagination pagination-sm inline">#}
                                {#<li><a href="#">Â«</a></li>#}
                                {#<li><a href="#">1</a></li>#}
                                {#</ul>#}
                            </div>
                        </div>
                        <div class="box-body">
                            <ul class="todo-list ui-sortable">
                                {{ include('AssociativeacademicBundle:BackendAssociativeacademic/Li:box_left.html.twig') }}
                            </ul>
                        </div>
                    </div>
                </div>
                {#ONE#}

                {#TWO#}
                <div id="{{ boxTwo.id }}" class="col-md-3">
                    <div class="box box-primary box-solid">
                        <div class="box-header with-border">
                            <h3 class="box-title">
                                <i class="fa fa-fw fa-{{ boxTwo.icon }}"></i> {{ boxTwo.title }}
                            </h3>
                            <div class="box-tools pull-right"></div>
                        </div>
                        <div class="box-body">
                            <ul class="todo-list ui-sortable">
                                <li>
                                    <span class="text">
                                        Seleccione un PDV.
                                    </span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
                {#TWO#}

                {#THREE#}
                <div id="{{ boxThree.id }}" class="col-md-3">
                    <div class="box box-warning box-solid">
                        <div class="box-header with-border">
                            <h3 class="box-title">
                                <i class="fa fa-fw fa-{{ boxThree.icon }}"></i> {{ boxThree.title }}
                            </h3>
                            <div class="box-tools pull-right"></div>
                        </div>
                        <div class="box-body">
                            <ul class="todo-list ui-sortable">
                                <li>
                                    <span class="text">
                                        Seleccione un usuario.
                                    </span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
                {#THREE#}

                {#FOUR#}
                <div id="{{ boxFour.id }}" class="col-md-3">
                    <div class="box box-warning box-solid">
                        <div class="box-header with-border">
                            <h3 class="box-title">
                                <i class="fa fa-fw fa-{{ boxFour.icon }}"></i> {{ boxFour.title }}
                            </h3>
                            <div class="box-tools pull-right"></div>
                        </div>
                        <div class="box-body">
                            <ul class="todo-list ui-sortable">
                                <li>
                                    <span class="text">
                                        Seleccione un usuario.
                                    </span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
                {#FOUR#}

            </div>

        </form>

    </section>

    {{ include('GridBundle:Modal:info.html.twig') }}

{% endblock %}